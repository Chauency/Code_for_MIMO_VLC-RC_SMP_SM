%4bits/channel-use
%RC
%warning off
close all
clear all
clc
width = 12;%??????????%7
height = 12*0.75;%??????????%7
fontsize = 20;%????????%16
linewidth = 2;%??????????2?????1?????
markersize = 9;%???????????????%6
ColorSet = [...
    0         0    1.0000
    0    0.5000         0
    1.0000         0         0
    0    0.7500    0.7500
    0.7500         0    0.7500
    0.7500    0.7500         0
    0.2500    0.2500     0.2500
    ];%????????????????????????
set(gcf, 'DefaultAxesColorOrder', ColorSet);%???????????
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RC 16PAM
for i = 1:1
    RC2 = [...
        81.000000 0.4894835938
        82.000000 0.4873187500
        83.000000 0.4867625000
        84.000000 0.4847804688
        85.000000 0.4822546875
        86.000000 0.4798507813
        87.000000 0.4767382813
        88.000000 0.4744937500
        89.000000 0.4714617187
        90.000000 0.4659625000
        91.000000 0.4620609375
        92.000000 0.4568062500
        93.000000 0.4510210937
        94.000000 0.4439398438
        95.000000 0.4373937500
        96.000000 0.4287531250
        97.000000 0.4192593750
        98.000000 0.4088851562
        99.000000 0.3986484375
        100.000000 0.3868953125
        101.000000 0.3747906250
        102.000000 0.3627992187
        103.000000 0.3483234375
        104.000000 0.3332523438
        105.000000 0.3169093750
        106.000000 0.3019281250
        107.000000 0.2845296875
        108.000000 0.2672617187
        109.000000 0.2493515625
        110.000000 0.2314929688
        111.000000 0.2125390625
        112.000000 0.1929445313
        113.000000 0.1739164062
        114.000000 0.1552632813
        115.000000 0.1376945313
        116.000000 0.1208226562
        117.000000 0.1049187500
        118.000000 0.0901054688
        119.000000 0.0758304688
        120.000000 0.0624992188
        121.000000 0.0496156250
        122.000000 0.0377273438
        123.000000 0.0271492187
        124.000000 0.0181500000
        125.000000 0.0112148438
        126.000000 0.0061789773
        127.000000 0.0029846191
        128.000000 0.0011733997
        129.000000 0.0003956091
        130.000000 0.0000998520
        131.000000 0.0000182719
        132.000000 0.0000022578
        133.000000 0.0000001953
        ];
    RC4 = [...
        81.000000 0.4907156250
        82.000000 0.4888125000
        83.000000 0.4884960938
        84.000000 0.4867328125
        85.000000 0.4846976563
        86.000000 0.4826062500
        87.000000 0.4797718750
        88.000000 0.4777750000
        89.000000 0.4753359375
        90.000000 0.4704921875
        91.000000 0.4670406250
        92.000000 0.4625125000
        93.000000 0.4572015625
        94.000000 0.4510929687
        95.000000 0.4452679688
        96.000000 0.4380468750
        97.000000 0.4292710938
        98.000000 0.4197625000
        99.000000 0.4103882812
        100.000000 0.3992328125
        101.000000 0.3879242187
        102.000000 0.3764656250
        103.000000 0.3636515625
        104.000000 0.3496500000
        105.000000 0.3340101563
        106.000000 0.3196492188
        107.000000 0.3020679688
        108.000000 0.2856710937
        109.000000 0.2689476563
        110.000000 0.2516296875
        111.000000 0.2332273438
        112.000000 0.2137039062
        113.000000 0.1948398437
        114.000000 0.1756234375
        115.000000 0.1573429688
        116.000000 0.1392000000
        117.000000 0.1223828125
        118.000000 0.1063742188
        119.000000 0.0911531250
        120.000000 0.0769828125
        121.000000 0.0637664063
        122.000000 0.0506070312
        123.000000 0.0388750000
        124.000000 0.0280570313
        125.000000 0.0188429688
        126.000000 0.0118382813
        127.000000 0.0065200425
        128.000000 0.0031403337
        129.000000 0.0012510008
        130.000000 0.0004475451
        131.000000 0.0001159128
        132.000000 0.0000209415
        133.000000 0.0000027500
        134.000000 0.0000002422
        135.000000 0.0000000078
        ];
    
    %SMP 2PAM %%%%%%%%%%%%%%%%%%%%%%%%%%
    SMP2=[...
        81.000000 0.4903507812
        82.000000 0.4883867188
        83.000000 0.4871265625
        84.000000 0.4863554688
        85.000000 0.4833687500
        86.000000 0.4815859375
        87.000000 0.4798429687
        88.000000 0.4770570312
        89.000000 0.4742070313
        90.000000 0.4708609375
        91.000000 0.4660296875
        92.000000 0.4621617188
        93.000000 0.4571906250
        94.000000 0.4517390625
        95.000000 0.4461265625
        96.000000 0.4392992188
        97.000000 0.4319695312
        98.000000 0.4236484375
        99.000000 0.4149656250
        100.000000 0.4057429687
        101.000000 0.3964679688
        102.000000 0.3860203125
        103.000000 0.3766812500
        104.000000 0.3665937500
        105.000000 0.3580546875
        106.000000 0.3488429687
        107.000000 0.3403671875
        108.000000 0.3323218750
        109.000000 0.3241804688
        110.000000 0.3173968750
        111.000000 0.3104539063
        112.000000 0.3069304688
        113.000000 0.3032812500
        114.000000 0.2998914062
        115.000000 0.2975921875
        116.000000 0.2953703125
        117.000000 0.2926914063
        118.000000 0.2905976563
        119.000000 0.2872007812
        120.000000 0.2835789062
        121.000000 0.2795164063
        122.000000 0.2753843750
        123.000000 0.2697562500
        124.000000 0.2635640625
        125.000000 0.2555718750
        126.000000 0.2466718750
        127.000000 0.2356804688
        128.000000 0.2236085938
        129.000000 0.2102648438
        130.000000 0.1952351563
        131.000000 0.1792460938
        132.000000 0.1624921875
        133.000000 0.1458773438
        134.000000 0.1298031250
        135.000000 0.1134460938
        136.000000 0.0978414062
        137.000000 0.0845796875
        138.000000 0.0741421875
        139.000000 0.0645328125
        140.000000 0.0587593750
        141.000000 0.0540929687
        142.000000 0.0499062500
        143.000000 0.0489945313
        144.000000 0.0473187500
        145.000000 0.0451390625
        146.000000 0.0429500000
        147.000000 0.0405109375
        148.000000 0.0383406250
        149.000000 0.0353718750
        150.000000 0.0329781250
        151.000000 0.0298281250
        152.000000 0.0264718750
        153.000000 0.0225875000
        154.000000 0.0194005229
        155.000000 0.0160140687
        156.000000 0.0122380604
        157.000000 0.0094863921
        158.000000 0.0065274151
        159.000000 0.0043180535
        160.000000 0.0026814051
        161.000000 0.0013386556
        162.000000 0.0006538901
        163.000000 0.0002695803
        164.000000 0.0000780306
        165.000000 0.0000178438
        166.000000 0.0000036562
        167.000000 0.0000002500
        ];
    SMP4=[...
        81.000000 0.4888359375
        82.000000 0.4873953125
        83.000000 0.4856281250
        84.000000 0.4844382812
        85.000000 0.4807726562
        86.000000 0.4788539063
        87.000000 0.4771218750
        88.000000 0.4741312500
        89.000000 0.4702585938
        90.000000 0.4662710937
        91.000000 0.4613179687
        92.000000 0.4561273438
        93.000000 0.4497523438
        94.000000 0.4421640625
        95.000000 0.4346085937
        96.000000 0.4253085938
        97.000000 0.4140742188
        98.000000 0.4015226563
        99.000000 0.3864929688
        100.000000 0.3695828125
        101.000000 0.3504156250
        102.000000 0.3280375000
        103.000000 0.3031851562
        104.000000 0.2760140625
        105.000000 0.2478664063
        106.000000 0.2184328125
        107.000000 0.1895734375
        108.000000 0.1626742187
        109.000000 0.1362171875
        110.000000 0.1098804688
        111.000000 0.0842210938
        112.000000 0.0596734375
        113.000000 0.0386054687
        114.000000 0.0227179688
        115.000000 0.0112613949
        116.000000 0.0046000981
        117.000000 0.0015804133
        118.000000 0.0003782809
        119.000000 0.0000701217
        120.000000 0.0000090703
        121.000000 0.0000005781
        ];
    
    
    %SM 4PAM
    SM2 = [...
        81.000000 0.4954750000
        82.000000 0.4941515625
        83.000000 0.4934984375
        84.000000 0.4932515625
        85.000000 0.4916671875
        86.000000 0.4898429688
        87.000000 0.4896195313
        88.000000 0.4877820313
        89.000000 0.4856648438
        90.000000 0.4843820313
        91.000000 0.4809203125
        92.000000 0.4778484375
        93.000000 0.4744476563
        94.000000 0.4700726563
        95.000000 0.4657429687
        96.000000 0.4599921875
        97.000000 0.4539164063
        98.000000 0.4463867188
        99.000000 0.4375585938
        100.000000 0.4281125000
        101.000000 0.4171437500
        102.000000 0.4037328125
        103.000000 0.3902445313
        104.000000 0.3751664062
        105.000000 0.3603671875
        106.000000 0.3445757812
        107.000000 0.3281078125
        108.000000 0.3125882812
        109.000000 0.2961492188
        110.000000 0.2814093750
        111.000000 0.2652281250
        112.000000 0.2502875000
        113.000000 0.2356093750
        114.000000 0.2226593750
        115.000000 0.2118539063
        116.000000 0.2000125000
        117.000000 0.1901210938
        118.000000 0.1809992188
        119.000000 0.1719789063
        120.000000 0.1628250000
        121.000000 0.1529570312
        122.000000 0.1425328125
        123.000000 0.1322687500
        124.000000 0.1214742188
        125.000000 0.1092500000
        126.000000 0.0977937500
        127.000000 0.0863523438
        128.000000 0.0753234375
        129.000000 0.0646945313
        130.000000 0.0552046875
        131.000000 0.0460875000
        132.000000 0.0386726563
        133.000000 0.0319804687
        134.000000 0.0255273438
        135.000000 0.0206453125
        136.000000 0.0161609375
        137.000000 0.0120375000
        138.000000 0.0086445313
        139.000000 0.0060931256
        140.000000 0.0037721664
        141.000000 0.0022562150
        142.000000 0.0011290668
        143.000000 0.0005169371
        144.000000 0.0001809934
        145.000000 0.0000530478
        146.000000 0.0000115024
        147.000000 0.0000015703
        148.000000 0.0000001563
        ];
    SM4 = [...
        81.000000 0.4874148437
        82.000000 0.4849500000
        83.000000 0.4834593750
        84.000000 0.4819757813
        85.000000 0.4787476562
        86.000000 0.4750898438
        87.000000 0.4732593750
        88.000000 0.4686992187
        89.000000 0.4639648438
        90.000000 0.4591359375
        91.000000 0.4519140625
        92.000000 0.4439828125
        93.000000 0.4351289063
        94.000000 0.4242031250
        95.000000 0.4123023438
        96.000000 0.3958242188
        97.000000 0.3782359375
        98.000000 0.3569625000
        99.000000 0.3323968750
        100.000000 0.3055976563
        101.000000 0.2768046875
        102.000000 0.2451312500
        103.000000 0.2155500000
        104.000000 0.1884921875
        105.000000 0.1643710938
        106.000000 0.1414765625
        107.000000 0.1202859375
        108.000000 0.1014812500
        109.000000 0.0836156250
        110.000000 0.0674921875
        111.000000 0.0523515625
        112.000000 0.0387937500
        113.000000 0.0271335938
        114.000000 0.0177679688
        115.000000 0.0106507813
        116.000000 0.0055350899
        117.000000 0.0025773810
        118.000000 0.0009975711
        119.000000 0.0003128067
        120.000000 0.0000722198
        121.000000 0.0000121996
        122.000000 0.0000014453
        123.000000 0.0000001250
        ];
    
    %%
    RSRC2=[...
        81.000000 0.4893515625
        81.500000 0.4885351562
        82.000000 0.4870585937
        82.500000 0.4876289062
        83.000000 0.4839218750
        83.500000 0.4843906250
        84.000000 0.4850117187
        84.500000 0.4837343750
        85.000000 0.4833203125
        85.500000 0.4809140625
        86.000000 0.4795742188
        86.500000 0.4783828125
        87.000000 0.4774531250
        87.500000 0.4751328125
        88.000000 0.4742890625
        88.500000 0.4720390625
        89.000000 0.4679492188
        89.500000 0.4679140625
        90.000000 0.4674648438
        90.500000 0.4655898438
        91.000000 0.4608593750
        91.500000 0.4604609375
        92.000000 0.4570312500
        92.500000 0.4541562500
        93.000000 0.4491992188
        93.500000 0.4465820313
        94.000000 0.4441406250
        94.500000 0.4403359375
        95.000000 0.4368789062
        95.500000 0.4321054688
        96.000000 0.4290546875
        96.500000 0.4228828125
        97.000000 0.4187187500
        97.500000 0.4144726563
        98.000000 0.4081210938
        98.500000 0.4029882813
        99.000000 0.3984492188
        99.500000 0.3919023437
        100.000000 0.3874921875
        100.500000 0.3803203125
        101.000000 0.3742578125
        101.500000 0.3688828125
        102.000000 0.3624140625
        102.500000 0.3547382813
        103.000000 0.3494218750
        103.500000 0.3404648438
        104.000000 0.3324257813
        104.500000 0.3262773438
        105.000000 0.3196406250
        105.500000 0.3096445313
        106.000000 0.3006718750
        106.500000 0.2929492188
        107.000000 0.2849843750
        107.500000 0.2763984375
        108.000000 0.2673867187
        108.500000 0.2580937500
        109.000000 0.2481210937
        109.500000 0.2404179687
        110.000000 0.2314882813
        110.500000 0.2215078125
        111.000000 0.2116367188
        111.500000 0.2033515625
        112.000000 0.1927460938
        112.500000 0.1844375000
        113.000000 0.1746718750
        113.500000 0.1636757813
        114.000000 0.1547695313
        114.500000 0.1461210937
        115.000000 0.1375078125
        115.500000 0.1294453125
        116.000000 0.1201132813
        116.500000 0.1127070313
        117.000000 0.1041523438
        117.500000 0.0974804687
        118.000000 0.0904960938
        118.500000 0.0833085938
        119.000000 0.0765625000
        119.500000 0.0685039062
        120.000000 0.0621331793
        120.500000 0.0560193526
        121.000000 0.0480390401
        121.500000 0.0379697969
        122.000000 0.0267269737
        122.500000 0.0146350102
        123.000000 0.0056550903
        123.500000 0.0014036277
        124.000000 0.0002256641
        124.500000 0.0000143750
        125.000000 0.0000009375
        ];
    
    RSRC4=[...
        81.000000 0.4908437500
        81.500000 0.4896562500
        82.000000 0.4886015625
        82.500000 0.4893125000
        83.000000 0.4854062500
        83.500000 0.4860625000
        84.000000 0.4868281250
        84.500000 0.4861250000
        85.000000 0.4857070312
        85.500000 0.4834179687
        86.000000 0.4823867188
        86.500000 0.4815585937
        87.000000 0.4807070313
        87.500000 0.4782109375
        88.000000 0.4775546875
        88.500000 0.4758515625
        89.000000 0.4717460937
        89.500000 0.4725000000
        90.000000 0.4719101562
        90.500000 0.4703046875
        91.000000 0.4657968750
        91.500000 0.4662304688
        92.000000 0.4627226562
        92.500000 0.4601132813
        93.000000 0.4556835938
        93.500000 0.4536601563
        94.000000 0.4513710938
        94.500000 0.4480937500
        95.000000 0.4451992188
        95.500000 0.4403867188
        96.000000 0.4381601562
        96.500000 0.4324804688
        97.000000 0.4284531250
        97.500000 0.4248007812
        98.000000 0.4194296875
        98.500000 0.4146640625
        99.000000 0.4101562500
        99.500000 0.4042382813
        100.000000 0.3994257813
        100.500000 0.3932539063
        101.000000 0.3873906250
        101.500000 0.3827421875
        102.000000 0.3759492187
        102.500000 0.3685234375
        103.000000 0.3642226563
        103.500000 0.3570117187
        104.000000 0.3494101562
        104.500000 0.3432304688
        105.000000 0.3365234375
        105.500000 0.3269101562
        106.000000 0.3181640625
        106.500000 0.3108437500
        107.000000 0.3033632813
        107.500000 0.2955312500
        108.000000 0.2865000000
        108.500000 0.2773203125
        109.000000 0.2675859375
        109.500000 0.2599492187
        110.000000 0.2516367187
        110.500000 0.2420312500
        111.000000 0.2323203125
        111.500000 0.2236132812
        112.000000 0.2138398438
        112.500000 0.2055078125
        113.000000 0.1956953125
        113.500000 0.1845390625
        114.000000 0.1750468750
        114.500000 0.1658906250
        115.000000 0.1570898438
        115.500000 0.1485703125
        116.000000 0.1386171875
        116.500000 0.1306953125
        117.000000 0.1211054688
        117.500000 0.1142539063
        118.000000 0.1066054688
        118.500000 0.0991523437
        119.000000 0.0915976563
        119.500000 0.0837265625
        120.000000 0.0770000000
        120.500000 0.0703710938
        121.000000 0.0633554688
        121.500000 0.0562437749
        122.000000 0.0494363515
        122.500000 0.0394682135
        123.000000 0.0285028901
        123.500000 0.0173293621
        124.000000 0.0067477888
        124.500000 0.0018427745
        125.000000 0.0003209766
        125.500000 0.0000271094
        126.000000 0.0000017578
        126.500000 0.0000000000
        ];
    
    %%
    RSSMP2=[...
        81.000000 0.4893632813
        81.500000 0.4897148438
        82.000000 0.4893945312
        82.500000 0.4891328125
        83.000000 0.4858515625
        83.500000 0.4862656250
        84.000000 0.4863750000
        84.500000 0.4834062500
        85.000000 0.4822031250
        85.500000 0.4826406250
        86.000000 0.4821757812
        86.500000 0.4813203125
        87.000000 0.4789296875
        87.500000 0.4787421875
        88.000000 0.4763164062
        88.500000 0.4749921875
        89.000000 0.4731992187
        89.500000 0.4723203125
        90.000000 0.4704101562
        90.500000 0.4690429688
        91.000000 0.4659570312
        91.500000 0.4660351563
        92.000000 0.4640156250
        92.500000 0.4616054688
        93.000000 0.4553281250
        93.500000 0.4537812500
        94.000000 0.4526640625
        94.500000 0.4479375000
        95.000000 0.4456914062
        95.500000 0.4432539063
        96.000000 0.4399257812
        96.500000 0.4354179688
        97.000000 0.4306953125
        97.500000 0.4281523438
        98.000000 0.4228632813
        98.500000 0.4181914063
        99.000000 0.4153789063
        99.500000 0.4100273438
        100.000000 0.4074375000
        100.500000 0.4012812500
        101.000000 0.3951679687
        101.500000 0.3903789062
        102.000000 0.3853828125
        102.500000 0.3828945313
        103.000000 0.3779023437
        103.500000 0.3721445313
        104.000000 0.3670703125
        104.500000 0.3625039063
        105.000000 0.3590117187
        105.500000 0.3541640625
        106.000000 0.3485390625
        106.500000 0.3443007813
        107.000000 0.3408593750
        107.500000 0.3357695312
        108.000000 0.3320000000
        108.500000 0.3283515625
        109.000000 0.3231640625
        109.500000 0.3217187500
        110.000000 0.3174882813
        110.500000 0.3134609375
        111.000000 0.3105000000
        111.500000 0.3096679688
        112.000000 0.3067265625
        112.500000 0.3032304687
        113.000000 0.3037070312
        113.500000 0.3024492188
        114.000000 0.3006171875
        114.500000 0.3005546875
        115.000000 0.2984843750
        115.500000 0.2953632813
        116.000000 0.2964726563
        116.500000 0.2951445313
        117.000000 0.2918242187
        117.500000 0.2907343750
        118.000000 0.2877265625
        118.500000 0.2884023438
        119.000000 0.2868242188
        119.500000 0.2863593750
        120.000000 0.2844375000
        120.500000 0.2807109375
        121.000000 0.2796796875
        121.500000 0.2775039062
        122.000000 0.2762968750
        122.500000 0.2718945313
        123.000000 0.2703164062
        123.500000 0.2661289063
        124.000000 0.2640781250
        124.500000 0.2597148437
        125.000000 0.2565898437
        125.500000 0.2506406250
        126.000000 0.2473007812
        126.500000 0.2420625000
        127.000000 0.2374765625
        127.500000 0.2320781250
        128.000000 0.2225000000
        128.500000 0.2180390625
        129.000000 0.2110820313
        129.500000 0.2015078125
        130.000000 0.1944179688
        130.500000 0.1868554688
        131.000000 0.1796015625
        131.500000 0.1713007813
        132.000000 0.1619609375
        132.500000 0.1530117188
        133.000000 0.1455078125
        133.500000 0.1368203125
        134.000000 0.1289569805
        134.500000 0.1197903659
        135.000000 0.1136668121
        135.500000 0.1030330435
        136.000000 0.0924289255
        136.500000 0.0795164832
        137.000000 0.0580255682
        137.500000 0.0368886914
        138.000000 0.0194695764
        138.500000 0.0092509678
        139.000000 0.0036334427
        139.500000 0.0013188132
        140.000000 0.0004676562
        140.500000 0.0002154297
        141.000000 0.0000788672
        141.500000 0.0000331641
        142.000000 0.0000255469
        142.500000 0.0000182813
        143.000000 0.0000111719
        143.500000 0.0000072656
        144.000000 0.0000065625
        144.500000 0.0000031250
        145.000000 0.0000009375
        145.500000 0.0000031250
        146.000000 0.0000010937
        146.500000 0.0000009375
        147.000000 0.0000015625
        147.500000 0.0000000000
        ];
    
    RSSMP2=[...%detele some tight points
        81.000000 0.4893632813
        81.500000 0.4897148438
        82.000000 0.4893945312
        82.500000 0.4891328125
        83.000000 0.4858515625
        83.500000 0.4862656250
        84.000000 0.4863750000
        84.500000 0.4834062500
        85.000000 0.4822031250
        85.500000 0.4826406250
        86.000000 0.4821757812
        86.500000 0.4813203125
        87.000000 0.4789296875
        87.500000 0.4787421875
        88.000000 0.4763164062
        88.500000 0.4749921875
        89.000000 0.4731992187
        89.500000 0.4723203125
        90.000000 0.4704101562
        90.500000 0.4690429688
        91.000000 0.4659570312
        91.500000 0.4660351563
        92.000000 0.4640156250
        92.500000 0.4616054688
        93.000000 0.4553281250
        93.500000 0.4537812500
        94.000000 0.4526640625
        94.500000 0.4479375000
        95.000000 0.4456914062
        95.500000 0.4432539063
        96.000000 0.4399257812
        96.500000 0.4354179688
        97.000000 0.4306953125
        97.500000 0.4281523438
        98.000000 0.4228632813
        98.500000 0.4181914063
        99.000000 0.4153789063
        99.500000 0.4100273438
        100.000000 0.4074375000
        %100.500000 0.4012812500
        101.000000 0.3951679687
        %101.500000 0.3903789062
        102.000000 0.3853828125
        %102.500000 0.3828945313
        103.000000 0.3779023437
        %103.500000 0.3721445313
        104.000000 0.3670703125
        %104.500000 0.3625039063
        105.000000 0.3590117187
        %105.500000 0.3541640625
        106.000000 0.3485390625
        %106.500000 0.3443007813
        107.000000 0.3408593750
        %107.500000 0.3357695312
        108.000000 0.3320000000
        %108.500000 0.3283515625
        109.000000 0.3231640625
        %109.500000 0.3217187500
        110.000000 0.3174882813
        %110.500000 0.3134609375
        111.000000 0.3105000000
        %111.500000 0.3096679688
        112.000000 0.3067265625
        %112.500000 0.3032304687
        113.000000 0.3037070312
        %113.500000 0.3024492188
        114.000000 0.3006171875
        %114.500000 0.3005546875
        115.000000 0.2984843750
        %115.500000 0.2953632813
        116.000000 0.2964726563
        % 116.500000 0.2951445313
        117.000000 0.2918242187
        %117.500000 0.2907343750
        118.000000 0.2877265625
        %118.500000 0.2884023438
        119.000000 0.2868242188
        %119.500000 0.2863593750
        120.000000 0.2844375000
        %120.500000 0.2807109375
        121.000000 0.2796796875
        %121.500000 0.2775039062
        122.000000 0.2762968750
        % 122.500000 0.2718945313
        123.000000 0.2703164062
        %123.500000 0.2661289063
        124.000000 0.2640781250
        %124.500000 0.2597148437
        125.000000 0.2565898437
        %125.500000 0.2506406250
        126.000000 0.2473007812
        %126.500000 0.2420625000
        127.000000 0.2374765625
        %127.500000 0.2320781250
        128.000000 0.2225000000
        %128.500000 0.2180390625
        129.000000 0.2110820313
        %129.500000 0.2015078125
        130.000000 0.1944179688
        %130.500000 0.1868554688
        131.000000 0.1796015625
        %131.500000 0.1713007813
        132.000000 0.1619609375
        %132.500000 0.1530117188
        133.000000 0.1455078125
        %133.500000 0.1368203125
        134.000000 0.1289569805
        %134.500000 0.1197903659
        135.000000 0.1136668121
        %135.500000 0.1030330435
        136.000000 0.0924289255
        136.500000 0.0795164832
        137.000000 0.0580255682
        137.500000 0.0368886914
        138.000000 0.0194695764
        138.500000 0.0092509678
        139.000000 0.0036334427
        139.500000 0.0013188132
        140.000000 0.0004676562
        140.500000 0.0002154297
        141.000000 0.0000788672
        141.500000 0.0000331641
        142.000000 0.0000255469
        142.500000 0.0000182813
        143.000000 0.0000111719
        143.500000 0.0000072656
        144.000000 0.0000065625
        144.500000 0.0000031250
        145.000000 0.0000009375
        145.500000 0.0000031250
        146.000000 0.0000010937
        146.500000 0.0000009375
        147.000000 0.0000015625
        147.500000 0.0000000000
        ];
    RSSMP4=[...
        81.000000 0.4883242187
        81.500000 0.4883281250
        %82.000000 0.4878398438
        82.500000 0.4883085938
        %83.000000 0.4846367187
        83.500000 0.4836992187
        %84.000000 0.4848671875
        84.500000 0.4814609375
        %85.000000 0.4801054687
        85.500000 0.4806640625
        %86.000000 0.4798164062
        86.500000 0.4786523437
        %87.000000 0.4766796875
        87.500000 0.4745781250
        %88.000000 0.4731132813
        88.500000 0.4709453125
        %89.000000 0.4697109375
        89.500000 0.4679960938
        %90.000000 0.4658710938
        90.500000 0.4641953125
        %91.000000 0.4602773438
        91.500000 0.4606718750
        %92.000000 0.4573203125
        92.500000 0.4546250000
        %93.000000 0.4478984375
        93.500000 0.4457851562
        %94.000000 0.4426210938
        94.500000 0.4376210938
        %95.000000 0.4336132812
        95.500000 0.4296835937
        %96.000000 0.4248710937
        96.500000 0.4208476562
        %97.000000 0.4128515625
        97.500000 0.4084648437
        %98.000000 0.4001640625
        98.500000 0.3929804687
        %99.000000 0.3885156250
        99.500000 0.3767656250
        %100.000000 0.3704804688
        100.500000 0.3612226563
        %101.000000 0.3489921875
        101.500000 0.3390117188
        %102.000000 0.3272539063
        102.500000 0.3171562500
        %103.000000 0.3042695313
        103.500000 0.2900742188
        %104.000000 0.2767187500
        104.500000 0.2627812500
        %105.000000 0.2470000000
        105.500000 0.2330156250
        %106.000000 0.2184531250
        106.500000 0.2030351562
        %107.000000 0.1896796875
        107.500000 0.1757500000
        %108.000000 0.1631757813
        108.500000 0.1477734375
        %109.000000 0.1355546875
        109.500000 0.1231757813
        %110.000000 0.1093007813
        110.500000 0.0970742187
        %111.000000 0.0835672405
        111.500000 0.0708786783
        112.000000 0.0530615482
        112.500000 0.0291677183
        113.000000 0.0093172396
        113.500000 0.0012541178
        114.000000 0.0000719141
        114.500000 0.0000020312
        ];
    
    %%
    RSSM2=[...
        100.000000 0.4278718750
        %100.500000 0.4225257813
        101.000000 0.4166601563
        %101.500000 0.4104710938
        102.000000 0.4040050781
        %102.500000 0.3975628906
        103.000000 0.3901992188
        %103.500000 0.3823417969
        104.000000 0.3757855469
        %104.500000 0.3679765625
        105.000000 0.3604898437
        %105.500000 0.3520140625
        106.000000 0.3445125000
        %106.500000 0.3367296875
        107.000000 0.3285578125
        %107.500000 0.3207238281
        108.000000 0.3123929688
        %108.500000 0.3046914063
        109.000000 0.2970417969
        %109.500000 0.2889605469
        110.000000 0.2812718750
        %110.500000 0.2728171875
        111.000000 0.2657632812
        %111.500000 0.2575031250
        112.000000 0.2504835938
        %112.500000 0.2431933594
        113.000000 0.2362042969
        %113.500000 0.2296074219
        114.000000 0.2230660156
        %114.500000 0.2171652344
        115.000000 0.2112933594
        %115.500000 0.2055777344
        116.000000 0.2007515625
        %116.500000 0.1952210937
        117.000000 0.1904464844
        %117.500000 0.1858417969
        118.000000 0.1812476563
        %118.500000 0.1761683594
        119.000000 0.1719230469
        %119.500000 0.1672246094
        120.000000 0.1628980469
       % 120.500000 0.1577863281
        121.000000 0.1528796875
       % 121.500000 0.1480183594
        122.000000 0.1430902344
       % 122.500000 0.1371796875
        123.000000 0.1324800781
       % 123.500000 0.1264910156
        124.000000 0.1207468750
        %124.500000 0.1148210938
        125.000000 0.1092144531
        %125.500000 0.1038007813
        126.000000 0.0975882813
       % 126.500000 0.0920234375
        127.000000 0.0862128631
        %127.500000 0.0809476563
        128.000000 0.0752945991
        %128.500000 0.0699981278
        129.000000 0.0648012663
        %129.500000 0.0590048334
        130.000000 0.0531950529
        130.500000 0.0471627481
        131.000000 0.0396510529
        131.500000 0.0316839398
        132.000000 0.0232257081
        132.500000 0.0157505196
        133.000000 0.0095077436
        133.500000 0.0052640632
        134.000000 0.0024984375
        134.500000 0.0010533984
        135.000000 0.0003752734
        135.500000 0.0001308984
        136.000000 0.0000351953
        136.500000 0.0000057031
        ];
    
    RSSM4=[...
        81.000000 0.4872734375
        81.500000 0.4871132812
        82.000000 0.4833007812
        82.500000 0.4864804688
        83.000000 0.4823632813
        83.500000 0.4812070312
        84.000000 0.4806406250
        84.500000 0.4799062500
        85.000000 0.4794570313
        85.500000 0.4780039063
        86.000000 0.4757304688
        86.500000 0.4742851563
        87.000000 0.4716406250
        87.500000 0.4724960938
        88.000000 0.4684804687
        88.500000 0.4652226562
        89.000000 0.4632187500
        89.500000 0.4616601563
        90.000000 0.4579648438
        90.500000 0.4565273437
        91.000000 0.4516992188
        91.500000 0.4506210937
        92.000000 0.4445351563
        92.500000 0.4416640625
        93.000000 0.4343750000
        93.500000 0.4301210938
        94.000000 0.4236679688
        94.500000 0.4174257813
        95.000000 0.4117304688
        95.500000 0.4024687500
        96.000000 0.3966875000
        96.500000 0.3884140625
        97.000000 0.3766132812
        97.500000 0.3689921875
        98.000000 0.3564062500
        98.500000 0.3465390625
        99.000000 0.3345468750
        99.500000 0.3187460938
        100.000000 0.3054101563
        %100.500000 0.2906015625
        101.000000 0.2776484375
       % 101.500000 0.2601757813
        102.000000 0.2457343750
       % 102.500000 0.2290546875
        103.000000 0.2164531250
       % 103.500000 0.2028984375
        104.000000 0.1893437500
       % 104.500000 0.1757578125
        105.000000 0.1645156250
        %105.500000 0.1524687500
        106.000000 0.1413320312
        %106.500000 0.1316132812
        107.000000 0.1211484375
        %107.500000 0.1111015625
        108.000000 0.1012070313
        %108.500000 0.0920664062
        109.000000 0.0834960938
        %109.500000 0.0748554688
        110.000000 0.0665584416
        %110.500000 0.0588868152
        111.000000 0.0498855257
        111.500000 0.0385618622
        112.000000 0.0280230978
        112.500000 0.0134134849
        113.000000 0.0044143406
        113.500000 0.0009341116
        114.000000 0.0001178516
        114.500000 0.0000082812
        115.000000 0.0000000000
        ];
    
    
    %%
    %BMST
    
    BMSTRC2=[...
        81.000000 0.5006262514
        81.500000 0.5001301446
        82.000000 0.5000622914
        82.500000 0.4992869855
        83.000000 0.5003681869
        83.500000 0.4995105673
        84.000000 0.4992458287
        84.500000 0.5007252503
        85.000000 0.4999299221
        85.500000 0.5003737486
        86.000000 0.4996340378
        86.500000 0.4996084538
        87.000000 0.4998008899
        87.500000 0.4992758621
        88.000000 0.5002647386
        88.500000 0.4993492770
        89.000000 0.4993926585
        89.500000 0.4991979978
        90.000000 0.5003926585
        90.500000 0.4993882091
        91.000000 0.5001212458
        91.500000 0.5006440489
        92.000000 0.5007252503
        92.500000 0.4999176863
        93.000000 0.4994760845
        93.500000 0.5004961068
        94.000000 0.5000000000
        94.500000 0.4995094549
        95.000000 0.5003637375
        95.500000 0.4992736374
        96.000000 0.5003815350
        96.500000 0.5000734149
        97.000000 0.4999065628
        97.500000 0.4997864294
        98.000000 0.4998609566
        98.500000 0.4994983315
        99.000000 0.4998431591
        99.500000 0.5004582870
        100.000000 0.4999933259
        100.500000 0.4999977753
        101.000000 0.4998932147
        101.500000 0.5012803115
        102.000000 0.4997942158
        102.500000 0.4990500556
        103.000000 0.4993281424
        103.500000 0.4999288098
        104.000000 0.4998320356
        104.500000 0.4997953281
        105.000000 0.5007864294
        105.500000 0.5002925473
        106.000000 0.4999165740
        106.500000 0.4991390434
        107.000000 0.5001245829
        107.500000 0.4994638487
        108.000000 0.4995962180
        108.500000 0.4990211346
        109.000000 0.4995951057
        109.500000 0.4983959956
        110.000000 0.4985939933
        110.500000 0.4988587319
        111.000000 0.4989899889
        111.500000 0.4988787542
        112.000000 0.4992169077
        112.500000 0.4980978865
        113.000000 0.4985038932
        113.500000 0.4961656220
        114.000000 0.3672291623
        114.500000 0.0002411789
        115.000000 0.0001382806
        115.500000 0.0000732999
        116.000000 0.0000410803
        116.500000 0.0000204672
        117.000000 0.0000105228
        117.500000 0.0000055284
        118.000000 0.0000021913
        118.500000 0.0000007898
        119.000000 0.0000003003
        119.500000 0.0000002336
        120.000000 0.0000000445
        120.500000 0.0000000667
        ];
    BMSTRC4=[...
        81.000000 0.5006384872
        81.500000 0.5001535039
        82.000000 0.5000378198
        82.500000 0.4993203560
        83.000000 0.5003870968
        83.500000 0.4995094549
        84.000000 0.4992313682
        84.500000 0.5007441602
        85.000000 0.4999354839
        85.500000 0.5003971079
        86.000000 0.4996351502
        86.500000 0.4996017798
        87.000000 0.4998120133
        87.500000 0.4992925473
        88.000000 0.5002480534
        88.500000 0.4993548387
        89.000000 0.4994115684
        89.500000 0.4992002225
        90.000000 0.5003670745
        90.500000 0.4993781980
        91.000000 0.5001412681
        91.500000 0.5006974416
        92.000000 0.5007830923
        92.500000 0.4998375973
        93.000000 0.4994660734
        93.500000 0.5004449388
        94.000000 0.4999833148
        94.500000 0.4995139043
        95.000000 0.5003737486
        95.500000 0.4991924360
        96.000000 0.5004471635
        96.500000 0.5000745273
        97.000000 0.4999377086
        97.500000 0.4998676307
        98.000000 0.4999010011
        98.500000 0.4996273637
        99.000000 0.4998754171
        99.500000 0.5004149055
        100.000000 0.4999543938
        100.500000 0.5000845384
        101.000000 0.4999010011
        101.500000 0.5013281424
        102.000000 0.4997652948
        102.500000 0.4988965517
        103.000000 0.4993181313
        103.500000 0.4999121246
        104.000000 0.4998898776
        104.500000 0.4998676307
        105.000000 0.5007641824
        105.500000 0.5005105673
        106.000000 0.5001657397
        106.500000 0.4991501669
        107.000000 0.5001323693
        107.500000 0.4997797553
        108.000000 0.4996051168
        108.500000 0.4989443826
        109.000000 0.4996084538
        109.500000 0.4983281424
        110.000000 0.4988042269
        110.500000 0.4988887653
        111.000000 0.4989588432
        111.500000 0.4990622914
        112.000000 0.4993670745
        112.500000 0.4983348165
        113.000000 0.4989566185
        113.500000 0.4980389321
        114.000000 0.4990144605
        114.500000 0.4941687558
        115.000000 0.4434577288
        115.500000 0.0002707275
        116.000000 0.0001529817
        116.500000 0.0000805004
        117.000000 0.0000436987
        117.500000 0.0000226585
        118.000000 0.0000115573
        118.500000 0.0000062069
        119.000000 0.0000024027
        119.500000 0.0000010567
        120.000000 0.0000005339
        120.500000 0.0000000667
        121.000000 0.0000000334
        ];
    %%
    
    BMSTSMP2=[...
        81.000000 0.5005305895
        81.500000 0.5001657397
        82.000000 0.5000333704
        82.500000 0.4993192436
        83.000000 0.5003592881
        83.500000 0.4994282536
        84.000000 0.4992235818
        84.500000 0.5007652948
        85.000000 0.4999933259
        85.500000 0.5003692992
        86.000000 0.4995895439
        86.500000 0.4996117909
        87.000000 0.4998420467
        87.500000 0.4992803115
        88.000000 0.5002068966
        88.500000 0.4994549499
        89.000000 0.4994037820
        89.500000 0.4992858732
        90.000000 0.5005094549
        90.500000 0.4993781980
        91.000000 0.5001390434
        91.500000 0.5007263626
        92.000000 0.5007563960
        92.500000 0.4998442714
        93.000000 0.4995406007
        93.500000 0.5003604004
        94.000000 0.5001434928
        94.500000 0.4995461624
        95.000000 0.5003392659
        95.500000 0.4991045606
        96.000000 0.5004048943
        96.500000 0.5001846496
        97.000000 0.4998654060
        97.500000 0.4999599555
        98.000000 0.5000444939
        98.500000 0.4996129032
        99.000000 0.4998642937
        99.500000 0.5003848721
        100.000000 0.5000723026
        100.500000 0.5000278087
        101.000000 0.4998375973
        101.500000 0.5013392659
        102.000000 0.4998665184
        102.500000 0.4988965517
        103.000000 0.4994927697
        103.500000 0.4998598443
        104.000000 0.4999588432
        104.500000 0.5000266963
        105.000000 0.5009966630
        105.500000 0.5004705228
        106.000000 0.5006151279
        106.500000 0.4993047831
        107.000000 0.5002736374
        107.500000 0.4998242492
        108.000000 0.4997586207
        108.500000 0.4993025584
        109.000000 0.4998921023
        109.500000 0.4986618465
        110.000000 0.4987830923
        110.500000 0.4994238042
        111.000000 0.4995428254
        111.500000 0.4999599555
        112.000000 0.5001334816
        112.500000 0.4991078977
        113.000000 0.4995050056
        113.500000 0.4992803115
        114.000000 0.5006484983
        114.500000 0.4991501669
        115.000000 0.4994393771
        115.500000 0.4996362625
        116.000000 0.4997708565
        116.500000 0.5000367075
        117.000000 0.5005139043
        117.500000 0.4986440489
        118.000000 0.4990934372
        118.500000 0.4996729700
        119.000000 0.4997753059
        119.500000 0.5004438265
        120.000000 0.4995417130
        120.500000 0.4994015573
        121.000000 0.4996173526
        121.500000 0.4993147942
        122.000000 0.4996106785
        122.500000 0.4993359288
        123.000000 0.4998765295
        123.500000 0.4988153504
        124.000000 0.4999955506
        124.500000 0.4993870968
        125.000000 0.4991913237
        125.500000 0.4993414905
        126.000000 0.5003114572
        126.500000 0.5007530590
        127.000000 0.4992814238
        127.500000 0.4993704116
        128.000000 0.4992591769
        128.500000 0.4993214683
        129.000000 0.4994048943
        129.500000 0.4994638487
        130.000000 0.4984549499
        130.500000 0.4984060067
        131.000000 0.4994771969
        131.500000 0.4977641824
        132.000000 0.4977085651
        132.500000 0.4974700210
        133.000000 0.4250865959
        133.500000 0.0002156845
        134.000000 0.0001015317
        134.500000 0.0000457732
        135.000000 0.0000201669
        135.500000 0.0000081424
        136.000000 0.0000025139
        136.500000 0.0000010456
        137.000000 0.0000004894
        137.500000 0.0000001001
        138.000000 0.0000000000
        ];
    
    BMSTSMP2=[...%delete some tight points
        81.000000 0.5005305895
        %81.500000 0.5001657397
        82.000000 0.5000333704
        %82.500000 0.4993192436
        83.000000 0.5003592881
        %83.500000 0.4994282536
        84.000000 0.4992235818
        %84.500000 0.5007652948
        85.000000 0.4999933259
        %85.500000 0.5003692992
        86.000000 0.4995895439
        %86.500000 0.4996117909
        87.000000 0.4998420467
        %87.500000 0.4992803115
        88.000000 0.5002068966
        %88.500000 0.4994549499
        89.000000 0.4994037820
        %89.500000 0.4992858732
        90.000000 0.5005094549
        %90.500000 0.4993781980
        91.000000 0.5001390434
        %91.500000 0.5007263626
        92.000000 0.5007563960
        %92.500000 0.4998442714
        93.000000 0.4995406007
        %93.500000 0.5003604004
        94.000000 0.5001434928
        %94.500000 0.4995461624
        95.000000 0.5003392659
        %95.500000 0.4991045606
        96.000000 0.5004048943
        %96.500000 0.5001846496
        97.000000 0.4998654060
        %97.500000 0.4999599555
        98.000000 0.5000444939
        %98.500000 0.4996129032
        99.000000 0.4998642937
        %99.500000 0.5003848721
        100.000000 0.5000723026
        %100.500000 0.5000278087
        101.000000 0.4998375973
        %101.500000 0.5013392659
        102.000000 0.4998665184
        %102.500000 0.4988965517
        103.000000 0.4994927697
        %103.500000 0.4998598443
        104.000000 0.4999588432
        %104.500000 0.5000266963
        105.000000 0.5009966630
        %105.500000 0.5004705228
        106.000000 0.5006151279
        %106.500000 0.4993047831
        107.000000 0.5002736374
        %107.500000 0.4998242492
        108.000000 0.4997586207
        %108.500000 0.4993025584
        109.000000 0.4998921023
        %109.500000 0.4986618465
        110.000000 0.4987830923
        %110.500000 0.4994238042
        111.000000 0.4995428254
        %111.500000 0.4999599555
        112.000000 0.5001334816
        %112.500000 0.4991078977
        113.000000 0.4995050056
        %113.500000 0.4992803115
        114.000000 0.5006484983
        %114.500000 0.4991501669
        115.000000 0.4994393771
        %115.500000 0.4996362625
        116.000000 0.4997708565
        %116.500000 0.5000367075
        117.000000 0.5005139043
        %117.500000 0.4986440489
        118.000000 0.4990934372
        %118.500000 0.4996729700
        119.000000 0.4997753059
        %119.500000 0.5004438265
        120.000000 0.4995417130
        %120.500000 0.4994015573
        121.000000 0.4996173526
        %121.500000 0.4993147942
        122.000000 0.4996106785
        %122.500000 0.4993359288
        123.000000 0.4998765295
        %123.500000 0.4988153504
        124.000000 0.4999955506
        %124.500000 0.4993870968
        125.000000 0.4991913237
        %125.500000 0.4993414905
        126.000000 0.5003114572
        %126.500000 0.5007530590
        127.000000 0.4992814238
        %127.500000 0.4993704116
        128.000000 0.4992591769
        %128.500000 0.4993214683
        129.000000 0.4994048943
        %129.500000 0.4994638487
        130.000000 0.4984549499
        %130.500000 0.4984060067
        131.000000 0.4994771969
        %131.500000 0.4977641824
        132.000000 0.4977085651
        132.500000 0.4974700210
        133.000000 0.4250865959
        133.500000 0.0002156845
        134.000000 0.0001015317
        134.500000 0.0000457732
        135.000000 0.0000201669
        135.500000 0.0000081424
        136.000000 0.0000025139
        136.500000 0.0000010456
        137.000000 0.0000004894
        137.500000 0.0000001001
        138.000000 0.0000000000
        ];
    BMSTSMP4=[...
        81.000000 0.5004894327
        81.500000 0.5001535039
        82.000000 0.5000189099
        82.500000 0.4993058954
        83.000000 0.5003370412
        83.500000 0.4994149055
        84.000000 0.4992358176
        84.500000 0.5007608454
        85.000000 0.4999488320
        85.500000 0.5003492770
        86.000000 0.4996106785
        86.500000 0.4995984427
        87.000000 0.4998654060
        87.500000 0.4992725250
        88.000000 0.5001924360
        88.500000 0.4994605117
        89.000000 0.4994193548
        89.500000 0.4992969967
        90.000000 0.5005272525
        % 90.500000 0.4993959956
        %91.000000 0.5001501669
        %91.500000 0.5007675195
        92.000000 0.5007664071
        %92.500000 0.4998298109
        %93.000000 0.4994938821
        %93.500000 0.5003470523
        94.000000 0.5001045606
        % 94.500000 0.4995528365
        % 95.000000 0.5002903226
        % 95.500000 0.4990967742
        96.000000 0.5003214683
        %96.500000 0.5001323693
        %97.000000 0.4998932147
        %97.500000 0.4998509455
        98.000000 0.5000500556
        %98.500000 0.4996206897
        %99.000000 0.4997842047
        %99.500000 0.5003325918
        100.000000 0.4999777531
        %100.500000 0.4999699666
        %101.000000 0.4997541713
        %101.500000 0.5011924360
        102.000000 0.4997730812
        %102.500000 0.4988064516
        %103.000000 0.4992614016
        %103.500000 0.4997931034
        104.000000 0.4996151279
        %104.500000 0.4995661846
        %105.000000 0.5006573971
        %105.500000 0.5000100111
        106.000000 0.4999165740
        %106.500000 0.4987074527
        %107.000000 0.4991701891
        %107.500000 0.4988264739
        %108.000000 0.4991434928
        108.500000 0.4946214357
        109.000000 0.2901194122
        109.500000 0.0002628526
        110.000000 0.0000792848
        110.500000 0.0000214572
        111.000000 0.0000059177
        111.500000 0.0000013571
        112.000000 0.0000001001
        112.500000 0.0000000334
        113.000000 0.0000000334
        ];
    %%
    
    BMSTSM2=[...
        81.000000 0.5005105673
        81.500000 0.5001779755
        82.000000 0.5000467186
        82.500000 0.4993359288
        83.000000 0.5003726363
        83.500000 0.4994260289
        84.000000 0.4992102336
        84.500000 0.5007630701
        85.000000 0.4999844271
        85.500000 0.5004015573
        86.000000 0.4995606229
        86.500000 0.4995895439
        87.000000 0.4998520578
        87.500000 0.4992958843
        88.000000 0.5002280311
        88.500000 0.4994783092
        89.000000 0.4994393771
        89.500000 0.4993459399
        90.000000 0.5005139043
        90.500000 0.4994048943
        91.000000 0.5001924360
        91.500000 0.5007897664
        92.000000 0.5007753059
        92.500000 0.4998431591
        93.000000 0.4995550612
        93.500000 0.5003793103
        94.000000 0.5001557286
        94.500000 0.4995806452
        95.000000 0.5003859844
        95.500000 0.4991446051
        96.000000 0.5004271413
        96.500000 0.5001590656
        97.000000 0.4999599555
        97.500000 0.4999699666
        98.000000 0.5001179088
        98.500000 0.4996607341
        99.000000 0.4999321468
        99.500000 0.5004048943
        100.000000 0.5001056730
        %100.500000 0.5001212458
        %101.000000 0.4998765295
        101.500000 0.5013036707
        %102.000000 0.4999766407
        %102.500000 0.4988987764
        103.000000 0.4994816463
        %103.500000 0.4998298109
        %104.000000 0.4999510567
        104.500000 0.5000556174
        %105.000000 0.5011212458
        %105.500000 0.5005005562
        106.000000 0.5004972191
        %106.500000 0.4992825362
        %107.000000 0.5001724138
        107.500000 0.4997508343
        %108.000000 0.4997652948
        %108.500000 0.4992246941
        109.000000 0.4997085651
        %109.500000 0.4984126808
        %110.000000 0.4988164627
        110.500000 0.4991468298
        %111.000000 0.4993236930
        %111.500000 0.4997319244
        112.000000 0.4997630701
        %112.500000 0.4986751947
        %113.000000 0.4991023359
        113.500000 0.4987452725
        %114.000000 0.5000934372
        %114.500000 0.4984282536
        115.000000 0.4985628476
        %115.500000 0.4987730812
        %116.000000 0.4972357677
        116.500000 0.4977619844
        117.000000 0.4368375576
        117.500000 0.0004496753
        118.000000 0.0003468991
        118.500000 0.0002956
        119.000000 0.0002326750
        119.500000 0.0001863187
        120.000000 0.0001449754
        120.000000 0.0001492566
        120.500000 0.0001199061
        121.000000 0.0000952344
        121.500000 0.0000714569
        122.000000 0.0000531758
        122.500000 0.0000395951
        123.000000 0.0000285350
        123.500000 0.0000192514
        124.000000 0.0000126870
        124.500000 0.0000095773];
    
    BMSTSM4=[...
        81.000000 0.5005038932
        81.500000 0.5001701891
        82.000000 0.5000467186
        82.500000 0.4993058954
        83.000000 0.5003648498
        83.500000 0.4994315907
        84.000000 0.4992213571
        84.500000 0.5007608454
        85.000000 0.4999788654
        85.500000 0.5003626251
        86.000000 0.4995428254
        86.500000 0.4995784205
        87.000000 0.4998565072
        87.500000 0.4992892102
        88.000000 0.5002202447
        88.500000 0.4994416018
        89.000000 0.4993882091
        89.500000 0.4993014461
        90.000000 0.5004916574
        90.500000 0.4993692992
        91.000000 0.5001457175
        91.500000 0.5007474972
        92.000000 0.5007285873
        92.500000 0.4997897664
        93.000000 0.4994927697
        93.500000 0.5003359288
        94.000000 0.5000878754
        94.500000 0.4994527253
        95.000000 0.5002636263
        95.500000 0.4991101224
        96.000000 0.5002769744
        96.500000 0.5000567297
        97.000000 0.4998387097
        97.500000 0.4998609566
        98.000000 0.4998364850
        98.500000 0.4994972191
        99.000000 0.4996807564
        99.500000 0.5002124583
        100.000000 0.4998131257
        100.500000 0.4998075640
        101.000000 0.4996151279
        %101.500000 0.5010478309
        %102.000000 0.4994994438
        102.500000 0.4985161290
        %103.000000 0.4985528365
        %103.500000 0.4992024472
        104.000000 0.4989399333
        %104.500000 0.4986562848
        %105.000000 0.4991379310
        105.500000 0.4891726454
        106.000000 0.0003520073
        106.500000 0.0001481352
        107.000000 0.0000654490
        107.500000 0.0000264961
        108.000000 0.0000108788
        108.500000 0.0000043604
        109.000000 0.0000012903
        109.500000 0.0000005673
        110.000000 0.0000002002
        110.500000 0.0000000334
        ];
    
    %%
    %%
    
    BMSTRC2lowerbound=[...
        %         109.500000 0.1398404526
        %         110.000000 0.0670672004
        %         110.500000 0.0220599092
        111.000000 0.0108972830
        111.500000 0.0067185406
        112.000000 0.0038388940
        112.500000 0.0022070144
        113.000000 0.0012781048
        113.500000 0.0007777641
        114.000000 0.0004286279
        114.500000 0.0002372503
        115.000000 0.0001337234
        115.500000 0.0000725009
        116.000000 0.0000390687
        116.500000 0.0000209896
        117.000000 0.0000103224
        117.500000 0.0000047941
        118.000000 0.0000026918
        118.500000 0.0000012347
        119.000000 0.0000004783
        119.500000 0.0000000667
        ];
    BMSTRC4lowerbound=[...
        %         110.500000 0.1513813308
        %         111.000000 0.0773403138
        111.500000 0.0277157040
        112.000000 0.0128081802
        112.500000 0.0071280826
        113.000000 0.0040916158
        113.500000 0.0024522196
        114.000000 0.0013780687
        114.500000 0.0008690570
        115.000000 0.0004688954
        115.500000 0.0002683572
        116.000000 0.0001475695
        116.500000 0.0000830060
        117.000000 0.0000431221
        117.500000 0.0000239150
        118.000000 0.0000122022
        118.500000 0.0000056061
        119.000000 0.0000031479
        119.500000 0.0000012792
        120.000000 0.0000005784
        120.500000 0.0000002336
        121.000000 0.0000000334
        ];
    %%
    
    BMSTSMP2lowerbound=[...
        81.000000 0.4924267150
        81.500000 0.4935290709
        82.000000 0.4926998062
        82.500000 0.4915608161
        83.000000 0.4914964287
        83.500000 0.4906238691
        84.000000 0.4895403853
        84.500000 0.4906616134
        85.000000 0.4886689358
        85.500000 0.4880850091
        86.000000 0.4863998366
        86.500000 0.4856216377
        87.000000 0.4852419743
        87.500000 0.4840397070
        88.000000 0.4831149714
        88.500000 0.4812910331
        89.000000 0.4817139914
        89.500000 0.4803940506
        90.000000 0.4786622528
        90.500000 0.4775143817
        91.000000 0.4757126459
        91.500000 0.4750365787
        92.000000 0.4733691682
        92.500000 0.4705538867
        93.000000 0.4685545483
        93.500000 0.4667494821
        94.000000 0.4652363793
        94.500000 0.4619959192
        95.000000 0.4600798403
        95.500000 0.4570258815
        96.000000 0.4555027875
        96.500000 0.4517716514
        97.000000 0.4474676898
        97.500000 0.4449044070
        98.000000 0.4413697633
        98.500000 0.4367849396
        99.000000 0.4335877744
        99.500000 0.4308823954
        100.000000 0.4250120449
        100.500000 0.4207935630
        101.000000 0.4159933748
        101.500000 0.4105959383
        102.000000 0.4066683097
        102.500000 0.4018026239
        103.000000 0.3960055418
        103.500000 0.3929460323
        104.000000 0.3875974414
        104.500000 0.3819180327
        105.000000 0.3778294357
        105.500000 0.3739994982
        106.000000 0.3695090353
        106.500000 0.3634199898
        107.000000 0.3608711387
        107.500000 0.3560609593
        108.000000 0.3516770686
        108.500000 0.3472287905
        109.000000 0.3437107986
        109.500000 0.3401261992
        110.000000 0.3363673099
        110.500000 0.3312418544
        111.000000 0.3285620084
        111.500000 0.3257767002
        112.000000 0.3242480556
        112.500000 0.3205546638
        113.000000 0.3192202913
        113.500000 0.3181190456
        114.000000 0.3168090959
        114.500000 0.3150895095
        115.000000 0.3117313760
        115.500000 0.3116370152
        116.000000 0.3087895399
        116.500000 0.3076849638
        117.000000 0.3070333193
        117.500000 0.3054924633
        118.000000 0.3036107984
        118.500000 0.3016736272
        119.000000 0.2996964913
        119.500000 0.2994544837
        120.000000 0.2968068313
        120.500000 0.2921387481
        121.000000 0.2913117036
        121.500000 0.2869799889
        122.000000 0.2840736769
        122.500000 0.2806111914
        123.000000 0.2757865803
        123.500000 0.2704701831
        124.000000 0.2652459264
        124.500000 0.2589759302
        125.000000 0.2530978088
        125.500000 0.2431199892
        126.000000 0.2339891962
        126.500000 0.2233730537
        127.000000 0.2089758192
        127.500000 0.1876769265
        128.000000 0.1642810042
        128.500000 0.1212735819
        129.000000 0.0727554901
        129.500000 0.0284076324
        130.000000 0.0162909156
        130.500000 0.0091664535
        131.000000 0.0047733430
        131.500000 0.0027922763
        132.000000 0.0015251392
        132.500000 0.0008311332
        133.000000 0.0004462513
        133.500000 0.0002167136
        134.000000 0.0001022805
        134.500000 0.0000475404
        135.000000 0.0000191765
        135.500000 0.0000074192
        136.000000 0.0000024582
        136.500000 0.0000009566
        137.000000 0.0000003337
        137.500000 0.0000001335
        ];
    BMSTSMP4lowerbound=[...
        81.000000 0.4916085515
        81.500000 0.4921525137
        82.000000 0.4913399008
        82.500000 0.4908325729
        83.000000 0.4901520652
        83.500000 0.4894315929
        84.000000 0.4879606749
        84.500000 0.4885734649
        85.000000 0.4872723963
        85.500000 0.4862510796
        86.000000 0.4851997895
        86.500000 0.4836012069
        87.000000 0.4828685232
        87.500000 0.4824633270
        88.000000 0.4808236697
        88.500000 0.4792306377
        89.000000 0.4794049276
        89.500000 0.4775243728
        90.000000 0.4752974585
        90.500000 0.4729639719
        91.000000 0.4717994489
        91.500000 0.4704140107
        92.000000 0.4677064114
        92.500000 0.4655372237
        93.000000 0.4620192318
        93.500000 0.4605627455
        94.000000 0.4572501271
        94.500000 0.4542994101
        95.000000 0.4501297738
        95.500000 0.4462321186
        96.000000 0.4419869938
        96.500000 0.4375331650
        97.000000 0.4334279161
        97.500000 0.4269214630
        98.000000 0.4215728721
        98.500000 0.4139773845
        99.000000 0.4074542794
        99.500000 0.3985699347
        100.000000 0.3896644975
        100.500000 0.3802772653
        101.000000 0.3694091239
        101.500000 0.3582801028
        102.000000 0.3462529890
        102.500000 0.3330391497
        103.000000 0.3165981718
        103.500000 0.3017402348
        104.000000 0.2828780703
        104.500000 0.2641113768
        105.000000 0.2423773143
        105.500000 0.2139314252
        106.000000 0.1759184634
        106.500000 0.1003043968
        107.000000 0.0288200018
        107.500000 0.0105124046
        108.000000 0.0041802002
        108.500000 0.0017470195
        109.000000 0.0006619638
        109.500000 0.0002473619
        110.000000 0.0000832534
        110.500000 0.0000215346
        111.000000 0.0000057062
        111.500000 0.0000012792
        112.000000 0.0000000334
        112.500000 0.0000000334
        ];
    %%
    
    BMSTSM2lowerbound=[...
        
%     110.000000 0.2503586723
%     110.500000 0.2258312557
%     111.000000 0.1932892232
%     111.500000 0.1296278345
%     112.000000 0.0361494766
     112.500000 0.0139155642
    113.000000 0.0078509282
    113.500000 0.0048691003
    114.000000 0.0032449136
    114.500000 0.0021799223
    115.000000 0.0015761507
    115.500000 0.0011368576
    116.000000 0.0008640957
    116.500000 0.0006614425
    117.000000 0.0005222911
    117.500000 0.0004215423
    118.000000 0.0003384167
    118.500000 0.0002736781
    119.000000 0.0002257356
    119.500000 0.0001833082
    120.000000 0.0001507521
    120.500000 0.0001161157
    121.000000 0.0000921986
    121.500000 0.0000712838
    122.000000 0.0000537897
    122.500000 0.0000392647
    123.000000 0.0000275650
    123.500000 0.0000193081
    124.000000 0.0000131713
    124.500000 0.0000086362
    125.000000 0.0000052492
    ];
BMSTSM4lowerbound=[...
    
% 81.000000 0.4907981590
% 81.500000 0.4906527324
% 82.000000 0.4900466031
% 82.500000 0.4890996650
% 83.000000 0.4887843890
% 83.500000 0.4868261253
% 84.000000 0.4869293671
% 84.500000 0.4863254581
% 85.000000 0.4854606693
% 85.500000 0.4836500525
% 86.000000 0.4830261612
% 86.500000 0.4808869469
% 87.000000 0.4797257543
% 87.500000 0.4778041248
% 88.000000 0.4766296106
% 88.500000 0.4739819582
% 89.000000 0.4746902191
% 89.500000 0.4719892806
% 90.000000 0.4684457559
% 90.500000 0.4663120922
% 91.000000 0.4632659042
% 91.500000 0.4614786001
% 92.000000 0.4581049247
% 92.500000 0.4532292478
% 93.000000 0.4497922953
% 93.500000 0.4451663969
% 94.000000 0.4404572390
% 94.500000 0.4351108684
% 95.000000 0.4291539280
% 95.500000 0.4222944545
% 96.000000 0.4122977627
% 96.500000 0.4059700399
% 97.000000 0.3966594064
% 97.500000 0.3868703083
% 98.000000 0.3753161086
% 98.500000 0.3618158566
% 99.000000 0.3469445980
% 99.500000 0.3321166344
% 100.000000 0.3153681514
% 100.500000 0.2959487033
% 101.000000 0.2767113160
% 101.500000 0.2502669855
% 102.000000 0.2206821063
% 102.500000 0.1779588765
% 103.000000 0.0950645983
103.500000 0.0239022194
104.000000 0.0087085065
104.500000 0.0036708796
105.000000 0.0016462105
105.500000 0.0007055458
106.000000 0.0003243750
106.500000 0.0001410322
107.000000 0.0000640346
107.500000 0.0000274967
108.000000 0.0000110231
108.500000 0.0000044159
109.000000 0.0000016685
109.500000 0.0000006674
110.000000 0.0000003003
110.500000 0.0000000000
];
%%

end
%%
%%
%BER of RC
h = figure(1);
fig(h, 'units','inches','width',width, 'height', height, 'font','Times New Roman','fontsize',fontsize);


semilogy(RC2(:,1), RC2(:,2),'r-','LineWidth',linewidth)
hold on;
%%
h =[...
    8.8278e-06   8.3394e-06   8.3394e-06   7.8917e-06
    8.3394e-06   8.8278e-06   7.8917e-06   8.3394e-06
    8.3394e-06   7.8917e-06   8.8278e-06   8.3394e-06
    7.8917e-06   8.3394e-06   8.3394e-06   8.8278e-06];
snr = 111:2:135;
N0 = 10.^(-0.1 * snr);
M = 16;
E_s = 1;
N_t = 4;
N_r = 4;
x = 1/(M-1).*sqrt(E_s./(N0*N_t^2)*sum(sum(h,1).^2));
ber_rc = 2*(M-1)/(M*log2(M)) .* Qfunction(x);
semilogy(snr,ber_rc,'ro')
%%
semilogy(RC4(:,1), RC4(:,2),'b-','LineWidth',linewidth)
%%
h=[...
    1.7002e-05   5.0134e-06   5.0134e-06   2.4286e-06
    5.0134e-06   1.7002e-05   2.4286e-06   5.0134e-06
    5.0134e-06   2.4286e-06   1.7002e-05   5.0134e-06
    2.4286e-06   5.0134e-06   5.0134e-06   1.7002e-05
    ];
snr = 111:2:135;
N0 = 10.^(-0.1 * snr);
M = 16;
E_s = 1;
N_t = 4;
N_r = 4;
x = 1/(M-1).*sqrt(E_s./(N0*N_t^2)*sum(sum(h,1).^2));
ber_rc = 2*(M-1)/(M*log2(M)) .* Qfunction(x);
semilogy(snr,ber_rc,'bo')
%%
hold on;

semilogy(RSRC2(:,1), RSRC2(:,2),'r>-','LineWidth',linewidth)
hold on;
semilogy(RSRC4(:,1), RSRC4(:,2),'b>-','LineWidth',linewidth)
hold on;

semilogy(BMSTRC2(:,1), BMSTRC2(:,2),'rs-','LineWidth',linewidth)
hold on;
semilogy(BMSTRC4(:,1), BMSTRC4(:,2),'bs-','LineWidth',linewidth)
hold on;

sl=[112.35,113.4];
plot([sl(1),sl(1)],[10e-7, 1],'r--','LineWidth',linewidth)
plot([sl(2),sl(2)],[10e-7, 1],'b--','LineWidth',linewidth)

semilogy(BMSTRC2lowerbound(:,1), BMSTRC2lowerbound(:,2),'r:','LineWidth',linewidth)
hold on;
semilogy(BMSTRC4lowerbound(:,1), BMSTRC4lowerbound(:,2),'b:','LineWidth',linewidth)
hold on;

grid on;
h_legend = legend(...
    'RC {\itP}_1 Simulation result',...
    'RC {\itP}_1 Theoretical bound',...
    'RC {\itP}_2 Simulation result',...
    'RC {\itP}_2 Theoretical bound',...
    'RS-RC {\itP}_1',...
    'RS-RC {\itP}_2',...
    'BMST-RC {\itP}_1',...
    'BMST-RC {\itP}_2',...
    'Shannon limit {\itP}_1',...
    'Shannon limit {\itP}_2',...
    'Lower bound BMST-RC {\itP}_1',...
    'Lower bound BMST-RC {\itP}_2',...
    'Location','northeast');%
axis([110,140,10^-5 ,1]);%??????
xlabel('SNR(1/\sigma^2)(dB)');%?????
ylabel('BER');%?????
set(get(gca,'Children'),'linewidth',linewidth);%??????
set(gca, 'XTick', 110:2:140);
set(get(gca,'Children'), 'markersize', markersize );%??????
%set(get(gca,'Children'), 'MarkerEdgeColor','b', 'MarkerFaceColor','b');%??????
print(gcf, '-depsc', 'BERRC.eps');%???eps?????color
print(gcf, '-dpng', 'BERRC.png');%???pdf?????color















%%
%BER of SMP
h = figure(2);
fig(h, 'units','inches','width',width, 'height', height, 'font','Times New Roman','fontsize',fontsize);


semilogy(SMP2(:,1), SMP2(:,2),'r-','LineWidth',linewidth)
hold on;
%%
h =[...
    8.8278e-06   8.3394e-06   8.3394e-06   7.8917e-06
    8.3394e-06   8.8278e-06   7.8917e-06   8.3394e-06
    8.3394e-06   7.8917e-06   8.8278e-06   8.3394e-06
    7.8917e-06   8.3394e-06   8.3394e-06   8.8278e-06];
snr = 81:2:170;
N0 = 10.^(-0.1 * snr);
M = 2;
E_s = 1;
N_t = 4;
N_r = 4;
r = 1;
T_s = 1;
s = [0,0,0,0
    0,0,0,0.5
    0,0,0.5,0
    0,0.5,0,0
    0.5,0,0,0
    0,0,0.5,0.5
    0,0.5,0,0.5
    0.5,0,0,0.5
    0.5,0,0.5,0
    0.5,0.5,0,0
    0,0.5,0.5,0
    0.5,0.5,0.5,0
    0.5,0.5,0,0.5
    0.5,0,0.5,0.5
    0,0.5,0.5,0.5
    0.5,0.5,0.5,0.5];
H_mult_s = (h*s')';
repmat_H_mult_s = repmat(H_mult_s,M^N_t,1);
kron_H_mult_s = kron(H_mult_s,ones(M^N_t,1));

repmat_s = repmat(s,M^N_t,1);
kron_s = kron(s,ones(M^N_t,1));
d_H = sum((repmat_s - kron_s)|(repmat_s - kron_s),2);
d_H_mult_s = sum((repmat_H_mult_s - kron_H_mult_s).^2,2);


repmat_N0 = repmat(N0,size(d_H_mult_s,1),1);
x = sqrt(r^2 .* T_s ./ (4 .* repmat_N0) .* repmat(d_H_mult_s,size(N0,1),size(N0,2)));
ber_smp = 1/(M^N_t*log2(M^N_t))* sum(repmat(d_H,size(N0,1),size(N0,2)).* Qfunction(x));
semilogy(snr,ber_smp,'ro')

%%
semilogy(SMP4(:,1), SMP4(:,2),'b-','LineWidth',linewidth)
hold on;
%%
h=[...
    1.7002e-05   5.0134e-06   5.0134e-06   2.4286e-06
    5.0134e-06   1.7002e-05   2.4286e-06   5.0134e-06
    5.0134e-06   2.4286e-06   1.7002e-05   5.0134e-06
    2.4286e-06   5.0134e-06   5.0134e-06   1.7002e-05
    ];
snr = 81:2:155;
N0 = 10.^(-0.1 * snr);
M = 2;
E_s = 1;
N_t = 4;
N_r = 4;
r = 1;
T_s = 1;
s = [0,0,0,0
    0,0,0,0.5
    0,0,0.5,0
    0,0.5,0,0
    0.5,0,0,0
    0,0,0.5,0.5
    0,0.5,0,0.5
    0.5,0,0,0.5
    0.5,0,0.5,0
    0.5,0.5,0,0
    0,0.5,0.5,0
    0.5,0.5,0.5,0
    0.5,0.5,0,0.5
    0.5,0,0.5,0.5
    0,0.5,0.5,0.5
    0.5,0.5,0.5,0.5];
H_mult_s = (h*s')';
repmat_H_mult_s = repmat(H_mult_s,M^N_t,1);
kron_H_mult_s = kron(H_mult_s,ones(M^N_t,1));

repmat_s = repmat(s,M^N_t,1);
kron_s = kron(s,ones(M^N_t,1));
d_H = sum((repmat_s - kron_s)|(repmat_s - kron_s),2);
d_H_mult_s = sum((repmat_H_mult_s - kron_H_mult_s).^2,2);


repmat_N0 = repmat(N0,size(d_H_mult_s,1),1);
x = sqrt(r^2 .* T_s ./ (4 .* repmat_N0) .* repmat(d_H_mult_s,size(N0,1),size(N0,2)));
ber_smp = 1/(M^N_t*log2(M^N_t))* sum(repmat(d_H,size(N0,1),size(N0,2)).* Qfunction(x));
semilogy(snr,ber_smp,'bo')

%%


semilogy(RSSMP2(:,1), RSSMP2(:,2),'r>-','LineWidth',linewidth)
hold on;
semilogy(RSSMP4(:,1), RSSMP4(:,2),'b>-','LineWidth',linewidth)
hold on;


semilogy(BMSTSMP2(:,1), BMSTSMP2(:,2),'rs-','LineWidth',linewidth)
hold on;
semilogy(BMSTSMP4(:,1), BMSTSMP4(:,2),'bs-','LineWidth',linewidth)
hold on;

sl=[115.2,107.65];
plot([sl(1),sl(1)],[10e-6, 1],'r--')
plot([sl(2),sl(2)],[10e-6, 1],'b--')
hold on;

semilogy(BMSTSMP2lowerbound(:,1), BMSTSMP2lowerbound(:,2),'r:','LineWidth',linewidth)
hold on;
semilogy(BMSTSMP4lowerbound(:,1), BMSTSMP4lowerbound(:,2),'b:','LineWidth',linewidth)
hold on;



grid on

h_legend = legend(...
    'SMP {\itP}_1 Simulation result',...
    'SMP {\itP}_1 Theoretical bound',...
    'SMP {\itP}_2 Simulation result',...
    'SMP {\itP}_2 Theoretical bound',...
    'RS-SMP {\itP}_1',...
    'RS-SMP {\itP}_2',...
    'BMST-SMP {\itP}_1',...
    'BMST-SMP {\itP}_2',...
    'Shannon limit {\itP}_1',...
    'Shannon limit {\itP}_2',...
    'Lower bound BMST-SMP {\itP}_1',...
    'Lower bound BMST-SMP {\itP}_2',...
    'Location','northeast');

hold off;
axis([100,170,10^-5 ,1]);%??????
xlabel('SNR(1/\sigma^2)(dB)');%?????
ylabel('BER');%?????
set(get(gca,'Children'),'linewidth',linewidth);%??????
%set(gca, 'XTick', 80:0.5:11);%???????
set(get(gca,'Children'), 'markersize', markersize );%??????
%set(get(gca,'Children'), 'MarkerEdgeColor','b', 'MarkerFaceColor','b');%??????
print(gcf, '-depsc', 'BERSMP.eps');%???eps?????color
print(gcf, '-dpng', 'BERSMP.png');%???pdf?????color

%%
%figure of SM
h = figure(3);
fig(h, 'units','inches','width',width, 'height', height, 'font','Times New Roman','fontsize',fontsize);

semilogy(SM2(:,1), SM2(:,2),'r-','LineWidth',linewidth)
hold on;

%%
h=[8.8278e-06   8.3394e-06   8.3394e-06   7.8917e-06
    8.3394e-06   8.8278e-06   7.8917e-06   8.3394e-06
    8.3394e-06   7.8917e-06   8.8278e-06   8.3394e-06
    7.8917e-06   8.3394e-06   8.3394e-06   8.8278e-06];
min_snr = 100;
arc_snr = 2;
max_snr = 175;

snr_array = min_snr : arc_snr:max_snr;
ber_sm = zeros(size(snr_array));
iter = 0;
for snr = min_snr : arc_snr:max_snr
    iter = iter + 1;
    N0 = 10.^(-0.1 * snr);
    M = 4;
    E_s = 1;
    N_t = 4;
    N_r = 4;
    r = 1;
    T_s = 1;
    d_H = [...
        0.4000         0         0         0
        0.8000         0         0         0
        1.6000         0         0         0
        1.2000         0         0         0
        0    0.4000         0         0
        0    0.8000         0         0
        0    1.6000         0         0
        0    1.2000         0         0
        0         0    0.4000         0
        0         0    0.8000         0
        0         0    1.6000         0
        0         0    1.2000         0
        0         0         0    0.4000
        0         0         0    0.8000
        0         0         0    1.6000
        0         0         0    1.2000
        ];
    I=[0.4000 0.8000 1.6000 1.2000];
    
    for m1 = 1:M
        for nt1 = 1:N_t
            for m2 = 1:M
                for nt2 = 1:N_t
                    %d_H = biterr(m1*nt1-1,m2*nt2-1);
                    d_H = biterr(m1+N_t*(nt1-1)-1,m2+N_t*(nt2-1)-1);
                    temp_sum =0;
                    for nr = 1:N_r
                        temp_sum = temp_sum + (I(m2)*h(nr,nt2) - I(m1)*h(nr,nt1))^2;
                    end
                    x  = sqrt(r^2 .* T_s ./ (4 .* N0) .* temp_sum);
                    ber_sm(iter) = ber_sm(iter) + d_H * Qfunction(x);
                end
            end
        end
    end
    ber_sm(iter) = ber_sm(iter) * 1/(M*N_t*log2(M*N_t));
    
end
semilogy(snr_array,ber_sm,'ro')
%%

semilogy(SM4(:,1), SM4(:,2),'b-','LineWidth',linewidth)
hold on;

%%
h=[...
    1.7002e-05   5.0134e-06   5.0134e-06   2.4286e-06
    5.0134e-06   1.7002e-05   2.4286e-06   5.0134e-06
    5.0134e-06   2.4286e-06   1.7002e-05   5.0134e-06
    2.4286e-06   5.0134e-06   5.0134e-06   1.7002e-05
    ];
min_snr = 100;
arc_snr = 2;
max_snr = 175;

snr_array = min_snr : arc_snr:max_snr;
ber_sm = zeros(size(snr_array));
iter = 0;
for snr = min_snr : arc_snr:max_snr
    iter = iter + 1;
    N0 = 10.^(-0.1 * snr);
    M = 4;
    E_s = 1;
    N_t = 4;
    N_r = 4;
    r = 1;
    T_s = 1;
    d_H = [...
        0.4000         0         0         0
        0.8000         0         0         0
        1.6000         0         0         0
        1.2000         0         0         0
        0    0.4000         0         0
        0    0.8000         0         0
        0    1.6000         0         0
        0    1.2000         0         0
        
        0         0    0.4000         0
        0         0    0.8000         0
        0         0    1.6000         0
        0         0    1.2000         0
        0         0         0    0.4000
        0         0         0    0.8000
        0         0         0    1.6000
        0         0         0    1.2000];
    
    I=[0.4000 0.8000 1.6000 1.2000];
    
    for m1 = 1:M
        for nt1 = 1:N_t
            for m2 = 1:M
                for nt2 = 1:N_t
                    %d_H = biterr(m1*nt1-1,m2*nt2-1);
                    d_H = biterr(m1+N_t*(nt1-1)-1,m2+N_t*(nt2-1)-1);
                    temp_sum =0;
                    for nr = 1:N_r
                        temp_sum = temp_sum + (I(m2)*h(nr,nt2) - I(m1)*h(nr,nt1))^2;
                    end
                    x  = sqrt(r^2 .* T_s ./ (4 .* N0) .* temp_sum);
                    ber_sm(iter) = ber_sm(iter) + d_H * Qfunction(x);
                end
            end
        end
    end
    ber_sm(iter) = ber_sm(iter) * 1/(M*N_t*log2(M*N_t));
    
end
semilogy(snr_array,ber_sm,'bo')
%%

semilogy(RSSM2(:,1), RSSM2(:,2),'r>-','LineWidth',linewidth)
hold on;
semilogy(RSSM4(:,1), RSSM4(:,2),'b>-','LineWidth',linewidth)
hold on;


semilogy(BMSTSM2(:,1), BMSTSM2(:,2),'rs-','LineWidth',linewidth)
hold on;
semilogy(BMSTSM4(:,1), BMSTSM4(:,2),'bs-','LineWidth',linewidth)
hold on;

semilogy(BMSTSM2lowerbound(:,1), BMSTSM2lowerbound(:,2),'r:','LineWidth',linewidth)
hold on;
semilogy(BMSTSM4lowerbound(:,1), BMSTSM4lowerbound(:,2),'b:','LineWidth',linewidth)
hold on;


sl=[115.600000,104.500000];
plot([sl(1),sl(1)],[10e-6, 1],'r--')
plot([sl(2),sl(2)],[10e-6, 1],'b--')

hold on;

grid on
axis([100 175 1e-5 1])
xlabel('SNR(1/\sigma^2)(dB)');
ylabel('BER');
grid on
h_legend = legend(...
    'SM {\itP}_1 Simulation result',...
    'SM {\itP}_1 Theoretical bound',...
    'SM {\itP}_2 Simulation result',...
    'SM {\itP}_2 Theoretical bound',...
    'RS-SM {\itP}_1',...
    'RS-SM {\itP}_2',...
    'BMST-SM {\itP}_1',...
    'BMST-SM {\itP}_2',...
    'Shannon limit {\itP}_1',...
    'Shannon limit {\itP}_2',...
    'Lower bound BMST-SM {\itP}_1',...
    'Lower bound BMST-SM {\itP}_2',...
    'Location','northeast');

hold off;

axis([100 160 1e-5 1]);%??????
xlabel('SNR(1/\sigma^2)(dB)');%?????
ylabel('BER');%?????
set(get(gca,'Children'),'linewidth',linewidth);%??????
%set(gca, 'XTick', 80:0.5:11);%???????
set(get(gca,'Children'), 'markersize', markersize );%??????
%set(get(gca,'Children'), 'MarkerEdgeColor','b', 'MarkerFaceColor','b');%??????
print(gcf, '-depsc', 'BERSM.eps');%???eps?????color
print(gcf, '-dpng', 'BERSM.png');%???pdf?????color












%%
% %BER of RCSMPSM
% h = figure(4);
%
% width = 7;%??????????%7
% height = 7*0.75;%??????????%7
% fontsize = 16;%????????%16
% fig(h, 'units','inches','width',width, 'height', height, 'font','Times New Roman','fontsize',fontsize);
%
%
%
%
%
% semilogy(RC2(:,1), RC2(:,2),'r:','LineWidth',linewidth)
% hold on;
% semilogy(RC4(:,1), RC4(:,2),'r--','LineWidth',linewidth)
% hold on;
% %semilogy(RC6(:,1), RC6(:,2),'r-','LineWidth',linewidth)
% hold on;
%
% semilogy(SMP2(:,1), SMP2(:,2),'g:','LineWidth',linewidth)
% hold on;
% semilogy(SMP4(:,1), SMP4(:,2),'g--','LineWidth',linewidth)
% hold on;
% %semilogy(SMP6(:,1), SMP6(:,2),'g-','LineWidth',linewidth)
% hold on;
%
% semilogy(SM2(:,1), SM2(:,2),'b:','LineWidth',linewidth)
% hold on;
% semilogy(SM4(:,1), SM4(:,2),'b--','LineWidth',linewidth)
% hold on;
% %semilogy(SM6(:,1), SM6(:,2),'b-','LineWidth',linewidth)
% hold on;
% axis([80 120 1e-5 1])
% %set(gca, 'FontName', 'Times New Roman');
%
% %%
% for j = 1:2
%     switch j
%         case 1
%
%             h =[...
%                 8.8278e-06   8.3394e-06   8.3394e-06   7.8917e-06
%                 8.3394e-06   8.8278e-06   7.8917e-06   8.3394e-06
%                 8.3394e-06   7.8917e-06   8.8278e-06   8.3394e-06
%                 7.8917e-06   8.3394e-06   8.3394e-06   8.8278e-06];
%
%         case 2
%             h=[...
%                 1.7002e-05   5.0134e-06   5.0134e-06   2.4286e-06
%                 5.0134e-06   1.7002e-05   2.4286e-06   5.0134e-06
%                 5.0134e-06   2.4286e-06   1.7002e-05   5.0134e-06
%                 2.4286e-06   5.0134e-06   5.0134e-06   1.7002e-05
%                 ];
%
%         case 3
%             h=[0.6888 0.5559 0.5559 0.0000
%                 0.5559 0.6888 0.0000 0.5559
%                 0.5559 0.0000 0.6888 0.5559
%                 0.0000 0.5559 0.5559 0.6888]*10^(-4);
%
%     end
%     %BER bound of RC
%     snr = 110:2:121;
%     N0 = 10.^(-0.1 * snr);
%     M = 16;
%     E_s = 1;
%     N_t = 4;
%     N_r = 4;
%     x = 1/(M-1).*sqrt(E_s./(N0*N_t^2)*sum(sum(h,1).^2));
%     ber_rc = 2*(M-1)/(M*log2(M)) .* Qfunction(x);
%     switch j
%         case 1
%             semilogy(snr,ber_rc,'r>')
%         case 2
%             semilogy(snr,ber_rc,'r>')
%         case 3
%             semilogy(snr,ber_rc,'r>')
%     end
%
%     hold on
%     %BER bound of SMP
%     snr = 81:2:121;
%     N0 = 10.^(-0.1 * snr);
%     M = 2;
%     E_s = 1;
%     N_t = 4;
%     N_r = 4;
%     r = 1;
%     T_s = 1;
%     s = [0,0,0,0
%         0,0,0,0.5
%         0,0,0.5,0
%         0,0.5,0,0
%         0.5,0,0,0
%         0,0,0.5,0.5
%         0,0.5,0,0.5
%         0.5,0,0,0.5
%         0.5,0,0.5,0
%         0.5,0.5,0,0
%         0,0.5,0.5,0
%         0.5,0.5,0.5,0
%         0.5,0.5,0,0.5
%         0.5,0,0.5,0.5
%         0,0.5,0.5,0.5
%         0.5,0.5,0.5,0.5];
%     H_mult_s = (h*s')';
%     repmat_H_mult_s = repmat(H_mult_s,M^N_t,1);
%     kron_H_mult_s = kron(H_mult_s,ones(M^N_t,1));
%
%     repmat_s = repmat(s,M^N_t,1);
%     kron_s = kron(s,ones(M^N_t,1));
%     d_H = sum((repmat_s - kron_s)|(repmat_s - kron_s),2);
%     d_H_mult_s = sum((repmat_H_mult_s - kron_H_mult_s).^2,2);
%
%
%     repmat_N0 = repmat(N0,size(d_H_mult_s,1),1);
%     x = sqrt(r^2 .* T_s ./ (4 .* repmat_N0) .* repmat(d_H_mult_s,size(N0,1),size(N0,2)));
%     ber_smp = 1/(M^N_t*log2(M^N_t))* sum(repmat(d_H,size(N0,1),size(N0,2)).* Qfunction(x));
%
%     switch j
%         case 1
%             semilogy(snr,ber_smp,'g*')
%         case 2
%             semilogy(snr,ber_smp,'g*')
%         case 3
%             semilogy(snr,ber_smp,'g*')
%     end
%     hold on
%
%     %BER bound of SM
%
%     min_snr = 81;
%     arc_snr = 2;
%     max_snr = 121;
%
%     snr_array = min_snr : arc_snr:max_snr;
%     ber_sm = zeros(size(snr_array));
%     iter = 0;
%     for snr = min_snr : arc_snr:max_snr
%         iter = iter + 1;
%         N0 = 10.^(-0.1 * snr);
%         M = 4;
%         E_s = 1;
%         N_t = 4;
%         N_r = 4;
%         r = 1;
%         T_s = 1;
%         d_H = [...
%             0.4000         0         0         0
%             0.8000         0         0         0
%             1.6000         0         0         0
%             1.2000         0         0         0
%             0    0.4000         0         0
%             0    0.8000         0         0
%             0    1.6000         0         0
%             0    1.2000         0         0
%             0         0         0    0.4000
%             0         0         0    0.8000
%             0         0         0    1.6000
%             0         0         0    1.2000
%             0         0    0.4000         0
%             0         0    0.8000         0
%             0         0    1.6000         0
%             0         0    1.2000         0];
%         I=[0.4000 0.8000 1.6000 1.2000];
%
%         for m1 = 1:M
%             for nt1 = 1:N_t
%                 for m2 = 1:M
%                     for nt2 = 1:N_t
%                         d_H = biterr(m1*nt1-1,m2*nt2-1);
%                         temp_sum =0;
%                         for nr = 1:N_r
%                             temp_sum = temp_sum + (I(m2)*h(nr,nt2) - I(m1)*h(nr,nt1))^2;
%                         end
%                         x  = sqrt(r^2 .* T_s ./ (4 .* N0) .* temp_sum);
%                         ber_sm(iter) = ber_sm(iter) + d_H * Qfunction(x);
%                     end
%                 end
%             end
%         end
%         ber_sm(iter) = ber_sm(iter) * 1/(M*N_t*log2(M*N_t));
%
%     end
%     switch j
%         case 1
%             semilogy(snr_array,ber_sm,'bs')
%         case 2
%             semilogy(snr_array,ber_sm,'bs')
%         case 3
%             semilogy(snr_array,ber_sm,'bs')
%     end
%     hold on
%
%
% end
% %%
%
%
%
%
% xlabel('SNR(1/\sigma^2)(dB)');
% ylabel('BER');
% grid on
% legend(...
%     'RC {\itP}_1',...
%     'RC {\itP}_2',...
%     'RC d_{Tx}=0.6',...
%     'SMP {\itP}_1',...
%     'SMP {\itP}_2',...
%     'SMP d_{Tx}=0.6',...
%     'SM {\itP}_1',...
%     'SM {\itP}_2',...
%     'SM d_{Tx}=0.6','Location','southwest');
% set(get(gca,'Children'),'linewidth',linewidth);%??????
% set(gca, 'XTick', 80:5:120);%???????
%
% set(get(gca,'Children'), 'markersize', markersize );%??????
% %set(get(gca,'Children'), 'MarkerEdgeColor','b', 'MarkerFaceColor','b');%??????
% print(gcf, '-depsc', 'BERRCSMPSM.eps');%???eps?????color
% print(gcf, '-dpng', 'BERRCSMPSM.png');%???pdf?????color
%
%
% %%
%
%
%
%
%


